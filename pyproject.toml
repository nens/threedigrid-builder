[project]
name = "threedigrid-builder"
authors = [
    {name = "Martijn Siemerink", email = "martijn.siemerink@nelen-schuurmans.nl"}
]
description = "Generate a 3Di simulation grid from a model schematisation."
readme = "README.rst"
requires-python = ">=3.8"
license = {text = "GNU General Public License v3.0"}
classifiers = [
    "Programming Language :: Python :: 3",
    "Intended Audience :: Science/Research",
    "Intended Audience :: Developers",
    "Development Status :: 5 - Production/Stable",
    "Topic :: Scientific/Engineering",
    "Topic :: Software Development",
    "Operating System :: Unix",
    "Operating System :: MacOS",
    "Operating System :: Microsoft :: Windows",
    "License :: Other/Proprietary License",
]
dependencies = [
    "numpy>=1.15,<1.25.0",
    "threedi-schema>=0.217.0",
    "shapely>=2",
    "pyproj>=3",
    "condenser[geo]>=0.1.1",
    "sqlalchemy>=1.4.1",
]
dynamic = ["version"]

[project.optional-dependencies]
test = ["pytest", "pytest-cov"]
gridadmin = ["h5py>=2.7"]
gpkg = ["geopandas"]
cli = ["typer"]

[project.urls]
Documentation = "https://docs.3di.lizard.net/"
Repository = "https://github.com/nens/threedigrid-builder"

[project.scripts]
threedigrid-builder = "threedigrid_builder.cli:run"

[build-system]
# numpy required to execute setup.py
requires = [
    "setuptools>=42",
    "wheel",
    "cmake>=3.18",
    "scikit-build",
    "numpy==1.13.3; python_version=='3.5'",
    "numpy==1.13.3; python_version=='3.6'",
    "numpy==1.14.5; python_version=='3.7'",
    "numpy==1.17.3; python_version=='3.8'",
    "numpy==1.19.3; python_version=='3.9'",
    "numpy==1.21.3; python_version=='3.10'",
    "numpy==1.24.2; python_version=='3.11'",
    # do not pin numpy on future versions of python to avoid incompatible numpy and python versions
    "numpy; python_version>='3.11'",
    "ninja; platform_system!='Windows'"
]

[tool.setuptools.dynamic]
version = {attr = "threedigrid_builder.__version__"}

[tool.isort]
profile = "black"
force_alphabetical_sort_within_sections = true

[tool.pytest.ini_options]
norecursedirs = [
    ".venv",
    "data",
    "doc",
    "etc",
    "*.egg-info",
    "misc",
    "var",
    "build",
    "lib",
    "include",
]
python_files = ["test_*.py"]
testpaths = ["threedigrid_builder"]
filterwarnings = ["error:::numpy"]
